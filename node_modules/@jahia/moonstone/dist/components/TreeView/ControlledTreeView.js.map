{"version":3,"sources":["ControlledTreeView.tsx"],"names":["React","clsx","Loading","ChevronDown","ChevronRight","Typography","displayIcon","icon","size","className","parentHasIconStart","props","displayIconOrLoading","isLoading","i","ControlledTreeViewForwardRef","ref","data","openedItems","selectedItems","onClickItem","undefined","onDoubleClickItem","onContextMenuItem","onOpenItem","onCloseItem","isReversed","component","itemComponent","isFlatData","filter","item","children","length","generateLevelJSX","nodeData","depth","map","node","hasChild","Boolean","hasChildren","hasIconStart","iconStart","isClosable","isOpen","includes","id","isSelected","toggleNode","e","handleNodeClick","handleNodeDoubleClick","handleNodeContextMenu","cssTreeViewItem","isDisabled","createElement","role","key","style","treeItemProps","typographyOptions","label","iconEnd","ControlledTreeView","forwardRef"],"mappings":";;;;;;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,IAAP,MAAiB,MAAjB;AACA;AAIA,SAAQC,OAAR,EAAiBC,WAAjB,EAA8BC,YAA9B;AACA,SAAQC,UAAR,wB,CAEA;;AACA,IAAMC,WAAW,GAAG,SAAdA,WAAc,CAACC,IAAD,EAA2BC,IAA3B,EAAyCC,SAAzC,EAA2F;AAAA,MAA/BC,kBAA+B,uEAAV,KAAU;;AAC3G,MAAI,CAACH,IAAD,IAAS,CAACG,kBAAd,EAAkC;AAC9B;AACH;;AAED,sBACI;AAAG,IAAA,SAAS,EAAET,IAAI,CAAC,SAAD,EAAY,aAAZ,EAA2BQ,SAA3B;AAAlB,KACKF,IAAI,iBACL,oBAAC,IAAD,CAAM,IAAN,eAAeA,IAAI,CAACI,KAApB;AAA2B,IAAA,IAAI,EAAEH;AAAjC,KAFJ,CADJ;AAMH,CAXD,C,CAaA;;;AACA,IAAMI,oBAAoB,GAAG,SAAvBA,oBAAuB,CAACL,IAAD,EAA2BM,SAA3B,EAAkD;AAC3E,MAAMC,CAAC,GAAGD,SAAS,gBAAG,oBAAC,OAAD;AAAS,IAAA,IAAI,EAAC,KAAd;AAAoB,IAAA,SAAS,EAAC;AAA9B,IAAH,GAAgEN,IAAnF;AAEA,SAAOD,WAAW,CAACQ,CAAD,EAAI,SAAJ,EAAe,gCAAf,CAAlB;AACH,CAJD;;AAMA,IAAMC,4BAAuG,GAAG,SAA1GA,4BAA0G,OAczGC,GAdyG,EAcjG;AAAA,MAZPC,IAYO,QAZPA,IAYO;AAAA,8BAXPC,WAWO;AAAA,MAXPA,WAWO,iCAXO,EAWP;AAAA,gCAVPC,aAUO;AAAA,MAVPA,aAUO,mCAVS,EAUT;AAAA,8BATPC,WASO;AAAA,MATPA,WASO,iCATO;AAAA,WAAMC,SAAN;AAAA,GASP;AAAA,mCARPC,iBAQO;AAAA,MARPA,iBAQO,sCARa;AAAA,WAAMD,SAAN;AAAA,GAQb;AAAA,mCAPPE,iBAOO;AAAA,MAPPA,iBAOO,sCAPa;AAAA,WAAMF,SAAN;AAAA,GAOb;AAAA,6BANPG,UAMO;AAAA,MANPA,UAMO,gCANM;AAAA,WAAMH,SAAN;AAAA,GAMN;AAAA,8BALPI,WAKO;AAAA,MALPA,WAKO,iCALO;AAAA,WAAMJ,SAAN;AAAA,GAKP;AAAA,6BAJPK,UAIO;AAAA,MAJPA,UAIO,gCAJM,KAIN;AAAA,4BAHPC,SAGO;AAAA,MAHPA,SAGO,+BAHK,IAGL;AAAA,gCAFPC,aAEO;AAAA,MAFPA,aAEO,mCAFS,IAET;AAAA,MADJjB,KACI;;AACX,MAAMkB,UAAU,GAAGZ,IAAI,CAACa,MAAL,CAAY,UAAAC,IAAI;AAAA,WAAIA,IAAI,CAACC,QAAL,IAAiBD,IAAI,CAACC,QAAL,CAAcC,MAAd,GAAuB,CAA5C;AAAA,GAAhB,EAA+DA,MAA/D,KAA0E,CAA7F;;AAEA,WAASC,gBAAT,CAA0BC,QAA1B,EAAoDC,KAApD,EAAmE1B,kBAAnE,EAAmH;AAC/G,WAAOyB,QAAQ,CAACE,GAAT,CAAa,UAAAC,IAAI,EAAI;AACxB,UAAMC,QAAQ,GAAGC,OAAO,CAACF,IAAI,CAACG,WAAL,IAAqBH,IAAI,CAACN,QAAL,IAAiBM,IAAI,CAACN,QAAL,CAAcC,MAAd,KAAyB,CAAhE,CAAxB;AACA,UAAMS,YAAY,GAAGF,OAAO,CAACF,IAAI,CAACK,SAAN,CAA5B;AACA,UAAMC,UAAU,GAAGJ,OAAO,CAACF,IAAI,CAACM,UAAL,KAAoB,KAArB,CAA1B;AACA,UAAMC,MAAM,GAAGL,OAAO,CAACtB,WAAW,CAAC4B,QAAZ,CAAqBR,IAAI,CAACS,EAA1B,CAAD,CAAP,IAA0C,CAACH,UAA1D;AACA,UAAM/B,SAAS,GAAG2B,OAAO,CAACF,IAAI,CAACzB,SAAN,CAAzB;AACA,UAAMmC,UAAU,GAAGR,OAAO,CAACrB,aAAa,CAAC2B,QAAd,CAAuBR,IAAI,CAACS,EAA5B,CAAD,CAA1B,CANwB,CAQxB;AACA;AACA;;AACA,UAAME,UAAU,GAAG,SAAbA,UAAa,CAACC,CAAD,EAAyB;AACxC,YAAIL,MAAJ,EAAY;AACRpB,UAAAA,WAAW,CAACa,IAAD,EAAOY,CAAP,CAAX;AACH,SAFD,MAEO;AACH1B,UAAAA,UAAU,CAACc,IAAD,EAAOY,CAAP,CAAV;AACH;AACJ,OAND;;AAQA,UAAMC,eAAe,GAAG,SAAlBA,eAAkB,CAACD,CAAD,EAAyB;AAC7C,YAAI9B,WAAW,CAACa,MAAZ,KAAuB,CAA3B,EAA8B;AAC1BgB,UAAAA,UAAU,CAACC,CAAD,CAAV;AACH;;AAED9B,QAAAA,WAAW,CAACkB,IAAD,EAAOY,CAAP,EAAUD,UAAV,CAAX;AACH,OAND;;AAQA,UAAMG,qBAAqB,GAAG,SAAxBA,qBAAwB,CAACF,CAAD,EAAyB;AACnD5B,QAAAA,iBAAiB,CAACgB,IAAD,EAAOY,CAAP,CAAjB;AACH,OAFD;;AAIA,UAAMG,qBAAqB,GAAG,SAAxBA,qBAAwB,CAACH,CAAD,EAAyB;AACnD3B,QAAAA,iBAAiB,CAACe,IAAD,EAAOY,CAAP,CAAjB;AACH,OAFD,CA/BwB,CAmCxB;AACA;AACA;;;AACA,UAAMI,eAAe,GAAGrD,IAAI,CACxB,iBADwB,EAExB,aAFwB,EAGxB,yBAHwB,EAIxB;AACI,8BAAsB+C,UAD1B;AAEI,8BAAsBtB,UAF1B;AAGI,8BAAsBY,IAAI,CAACiB;AAH/B,OAJwB,CAA5B;AAWA,2BACIvD,KAAK,CAACwD,aAAN,CACI5B,aADJ;AAGQ6B,QAAAA,IAAI,EAAE,UAHd;AAIQ,yBAAiBZ,MAJzB;AAKQa,QAAAA,GAAG,YAAKtB,KAAL,cAAcE,IAAI,CAACS,EAAnB,CALX;AAMQY,QAAAA,KAAK,EAAE;AAAC,8BAAoBvB;AAArB;AANf,SAOWE,IAAI,CAACsB,aAPhB,gBASI;AAAK,QAAA,SAAS,EAAEN;AAAhB,SAEKV,UAAU,IAAIL,QAAd,iBACG;AACI,QAAA,SAAS,EAAEtC,IAAI,CAAC,SAAD,EAAY,aAAZ,EAA2B,+BAA3B,CADnB;AAEI,QAAA,OAAO,EAAEgD;AAFb,SAIKJ,MAAM,gBAAG,oBAAC,WAAD,OAAH,gBAAoB,oBAAC,YAAD,OAJ/B,CAHR,EAUK,CAAChB,UAAD,IAAe,CAACU,QAAhB,iBACG;AAAK,QAAA,SAAS,EAAEtC,IAAI,CAAC,SAAD,EAAY,aAAZ,EAA2B,+BAA3B;AAApB,QAXR,eAcI;AACI,QAAA,SAAS,EAAEA,IAAI,CAAC,gBAAD,EAAmB,aAAnB,EAAkC,WAAlC,EAA+C,8BAA/C,EAA+EqC,IAAI,CAAC7B,SAApF,CADnB;AAEI,QAAA,OAAO,EAAE6B,IAAI,CAACiB,UAAL,GAAkBlC,SAAlB,GAA8B8B,eAF3C;AAGI,QAAA,aAAa,EAAEC,qBAHnB;AAII,QAAA,aAAa,EAAEC;AAJnB,SAMK/C,WAAW,CAACgC,IAAI,CAACK,SAAN,EAAiB,OAAjB,EAA0B,kCAA1B,EAA8DjC,kBAA9D,CANhB,eAOI,oBAAC,UAAD;AAAY,QAAA,QAAQ,MAApB;AACY,QAAA,SAAS,EAAET,IAAI,CAAC,WAAD,CAD3B;AAEY,QAAA,SAAS,EAAC,MAFtB;AAGY,QAAA,OAAO,EAAC;AAHpB,SAIgBqC,IAAI,CAACuB,iBAJrB,GAMKvB,IAAI,CAACwB,KANV,CAPJ,EAeKlD,oBAAoB,CAAC0B,IAAI,CAACyB,OAAN,EAAelD,SAAf,CAfzB,CAdJ,CATJ,CADJ,4BA2CSgC,MAAM,IAAIP,IAAI,CAACN,QAAhB,GAA4BE,gBAAgB,CAACI,IAAI,CAACN,QAAN,EAAgBY,UAAU,GAAIR,KAAK,GAAG,CAAZ,GAAiBA,KAA3C,EAAkDM,YAAlD,CAA5C,GAA8G,EA3CtH;AA6CH,KA9FM,CAAP;AA+FH,GAnGU,CAqGX;;;AACA,sBAAO1C,KAAK,CAACwD,aAAN,CAAoB7B,SAApB;AAAgCX,IAAAA,GAAG,EAAHA,GAAhC;AAAqCyC,IAAAA,IAAI,EAAE;AAA3C,KAAsD9C,KAAtD,GAA8DuB,gBAAgB,CAACjB,IAAD,EAAO,CAAP,EAAU,KAAV,CAA9E,CAAP;AACH,CArHD;;AAuHA,OAAO,IAAM+C,kBAAkB,gBAAGhE,KAAK,CAACiE,UAAN,CAAiBlD,4BAAjB,CAA3B","sourcesContent":["import React from 'react';\nimport clsx from 'clsx';\nimport './TreeView.scss';\nimport {ControlledTreeViewProps} from './ControlledTreeView.types';\nimport {TreeViewData} from './TreeView.types';\n\nimport {Loading, ChevronDown, ChevronRight} from '~/icons';\nimport {Typography} from '~/components/Typography';\n\n// Manage treeView_item's icon\nconst displayIcon = (icon: React.ReactElement, size: string, className: string, parentHasIconStart = false) => {\n    if (!icon && !parentHasIconStart) {\n        return;\n    }\n\n    return (\n        <i className={clsx('flexRow', 'alignCenter', className)}>\n            {icon &&\n            <icon.type {...icon.props} size={size}/>}\n        </i>\n    );\n};\n\n// Manage if we display icon or loading\nconst displayIconOrLoading = (icon: React.ReactElement, isLoading: boolean) => {\n    const i = isLoading ? <Loading size=\"big\" className=\"moonstone-icon_isLoading\"/> : icon;\n\n    return displayIcon(i, 'default', 'moonstone-treeView_itemIconEnd');\n};\n\nconst ControlledTreeViewForwardRef: React.ForwardRefRenderFunction<HTMLUListElement, ControlledTreeViewProps> = (\n    {\n        data,\n        openedItems = [],\n        selectedItems = [],\n        onClickItem = () => undefined,\n        onDoubleClickItem = () => undefined,\n        onContextMenuItem = () => undefined,\n        onOpenItem = () => undefined,\n        onCloseItem = () => undefined,\n        isReversed = false,\n        component = 'ul',\n        itemComponent = 'li',\n        ...props\n    }, ref) => {\n    const isFlatData = data.filter(item => item.children && item.children.length > 0).length === 0;\n\n    function generateLevelJSX(nodeData: TreeViewData[], depth: number, parentHasIconStart: boolean): React.ReactNode[] {\n        return nodeData.map(node => {\n            const hasChild = Boolean(node.hasChildren || (node.children && node.children.length !== 0));\n            const hasIconStart = Boolean(node.iconStart);\n            const isClosable = Boolean(node.isClosable !== false);\n            const isOpen = Boolean(openedItems.includes(node.id)) || !isClosable;\n            const isLoading = Boolean(node.isLoading);\n            const isSelected = Boolean(selectedItems.includes(node.id));\n\n            // ---\n            // Manage clicks events\n            // ---\n            const toggleNode = (e: React.MouseEvent) => {\n                if (isOpen) {\n                    onCloseItem(node, e);\n                } else {\n                    onOpenItem(node, e);\n                }\n            };\n\n            const handleNodeClick = (e: React.MouseEvent) => {\n                if (onClickItem.length === 0) {\n                    toggleNode(e);\n                }\n\n                onClickItem(node, e, toggleNode);\n            };\n\n            const handleNodeDoubleClick = (e: React.MouseEvent) => {\n                onDoubleClickItem(node, e);\n            };\n\n            const handleNodeContextMenu = (e: React.MouseEvent) => {\n                onContextMenuItem(node, e);\n            };\n\n            // ---\n            // Define CSS treeView_item classes\n            // ---\n            const cssTreeViewItem = clsx(\n                'flexRow_between',\n                'alignCenter',\n                'moonstone-treeView_item',\n                {\n                    'moonstone-selected': isSelected,\n                    'moonstone-reversed': isReversed,\n                    'moonstone-disabled': node.isDisabled\n                }\n            );\n\n            return [\n                React.createElement(\n                    itemComponent,\n                    {\n                        role: 'treeitem',\n                        'aria-expanded': isOpen,\n                        key: `${depth}-${node.id}`,\n                        style: {'--treeItem-depth': depth},\n                        ...node.treeItemProps\n                    },\n                    <div className={cssTreeViewItem}>\n                        {/* Icon arrow */}\n                        {isClosable && hasChild && (\n                            <div\n                                className={clsx('flexRow', 'alignCenter', 'moonstone-treeView_itemToggle')}\n                                onClick={toggleNode}\n                            >\n                                {isOpen ? <ChevronDown/> : <ChevronRight/>}\n                            </div>\n                        )}\n                        {!isFlatData && !hasChild &&\n                            <div className={clsx('flexRow', 'alignCenter', 'moonstone-treeView_itemToggle')}/>}\n\n                        {/* TreeViewItem */}\n                        <div\n                            className={clsx('flexRow_nowrap', 'alignCenter', 'flexFluid', 'moonstone-treeView_itemLabel', node.className)}\n                            onClick={node.isDisabled ? undefined : handleNodeClick}\n                            onDoubleClick={handleNodeDoubleClick}\n                            onContextMenu={handleNodeContextMenu}\n                        >\n                            {displayIcon(node.iconStart, 'small', 'moonstone-treeView_itemIconStart', parentHasIconStart)}\n                            <Typography isNowrap\n                                        className={clsx('flexFluid')}\n                                        component=\"span\"\n                                        variant=\"body\"\n                                        {...node.typographyOptions}\n                            >\n                                {node.label}\n                            </Typography>\n                            {displayIconOrLoading(node.iconEnd, isLoading)}\n                        </div>\n                    </div>\n                ),\n                ...((isOpen && node.children) ? generateLevelJSX(node.children, isClosable ? (depth + 1) : depth, hasIconStart) : [])\n            ];\n        });\n    }\n\n    // TreeView component\n    return React.createElement(component, {ref, role: 'tree', ...props}, generateLevelJSX(data, 0, false));\n};\n\nexport const ControlledTreeView = React.forwardRef(ControlledTreeViewForwardRef);\n"]}