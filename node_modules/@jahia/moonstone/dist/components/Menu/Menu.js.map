{"version":3,"sources":["Menu.tsx"],"names":["React","useState","useEffect","usePositioning","useEnterExitCallbacks","clsx","SearchInput","Typography","getChildrenToFilter","children","props","reduce","acc","curr","Menu","isDisplayed","position","minWidth","maxWidth","maxHeight","className","style","onMouseEnter","onMouseLeave","anchorEl","anchorElOrigin","transformElOrigin","anchorPosition","onClose","onEntering","onEntered","onExiting","onExited","hasOverlay","hasSearch","searchEmptyText","stylePosition","itemRef","inputValue","setInputValue","filteredChildren","setFilteredChildren","isEmptySearch","setIsEmptySearch","Array","isArray","_childrenToFilter","_filtered","filter","child","label","contains","toLowerCase","includes","variant","length","Children","count","styleMenu","e","target","value","defaultProps","top","left","vertical","horizontal","displayName"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react';\nimport {usePositioning} from '~/hooks/usePositioning';\nimport {useEnterExitCallbacks} from '~/hooks/useEnterExitCallbacks';\nimport clsx from 'clsx';\nimport './Menu.scss';\nimport {MenuProps} from './Menu.types';\nimport {SearchInput} from '~/components/Input';\nimport {Typography} from '~/components/Typography';\n\nconst getChildrenToFilter = (children: [React.ReactElement]) => {\n    if (children[0].props['data-option-type'] === 'group') {\n        return children.reduce((acc, curr) => {\n            return [...acc, ...curr.props.children[2]];\n        }, []);\n    }\n\n    return children;\n};\n\nexport const Menu: React.FC<MenuProps> = ({\n    children,\n    isDisplayed,\n    position,\n    minWidth,\n    maxWidth,\n    maxHeight,\n    className,\n    style,\n    onMouseEnter,\n    onMouseLeave,\n    anchorEl,\n    anchorElOrigin,\n    transformElOrigin,\n    anchorPosition,\n    onClose,\n    onEntering,\n    onEntered,\n    onExiting,\n    onExited,\n    hasOverlay,\n    hasSearch,\n    searchEmptyText,\n    ...props\n}) => {\n    const [stylePosition, itemRef] = usePositioning(isDisplayed, anchorPosition, anchorEl, anchorElOrigin, transformElOrigin, position);\n    useEnterExitCallbacks(isDisplayed, onExiting, onExited, onEntering, onEntered);\n    const [inputValue, setInputValue] = useState('');\n    const [filteredChildren, setFilteredChildren] = useState(children);\n    const [isEmptySearch, setIsEmptySearch] = useState(false);\n    // UseEffect hook to filter the search results and determine whether to show the no search results text\n    useEffect(() => {\n        if (inputValue !== '' && Array.isArray(children)) {\n            const _childrenToFilter = getChildrenToFilter(children as [React.ReactElement]);\n            const _filtered = _childrenToFilter.filter((child: React.ReactElement) => {\n                if (child.props && child.props.label) {\n                    const contains = child.props.label.toLowerCase().includes(inputValue.toLowerCase());\n                    return contains && child.props.variant !== 'title';\n                }\n\n                return false;\n            });\n            setFilteredChildren(_filtered);\n\n            if (_filtered.length === 0) {\n                setIsEmptySearch(true);\n            } else {\n                setIsEmptySearch(false);\n            }\n        } else {\n            setFilteredChildren(null);\n            setIsEmptySearch(false);\n        }\n    }, [inputValue, children]);\n\n    if (!children || React.Children.count(children) < 1) {\n        return null;\n    }\n\n    // ---\n    // Styling\n    // ---\n    const styleMenu: React.CSSProperties = {\n        position,\n        ...stylePosition as React.CSSProperties,\n        ...style\n    };\n\n    if (minWidth) {\n        styleMenu.minWidth = minWidth;\n    }\n\n    if (maxWidth) {\n        styleMenu.maxWidth = maxWidth;\n    }\n\n    if (maxHeight) {\n        styleMenu.maxHeight = maxHeight;\n    }\n\n    // ---\n    // Render\n    // ---\n    return (\n        <>\n            <menu\n                ref={itemRef}\n                style={styleMenu}\n                role=\"listbox\"\n                className={clsx(\n                    'moonstone-menu',\n                    className,\n                    {'moonstone-hidden': !isDisplayed || !stylePosition}\n                )}\n                onMouseEnter={onMouseEnter}\n                onMouseLeave={onMouseLeave}\n                {...props}\n            >\n                { hasSearch && (\n                    <div className=\"moonstone-menu_searchInput\">\n                        <SearchInput\n                            focusOnField\n                            value={inputValue}\n                            onChange={e => setInputValue(e.target.value)}\n                            onClear={() => setInputValue('')}\n                        />\n                    </div>\n                )}\n                {filteredChildren || children}\n                {isEmptySearch && (\n                    <Typography\n                        className=\"moonstone-menu_emptySearchText\"\n                        variant=\"caption\"\n                    >\n                        {searchEmptyText}\n                    </Typography>\n                )}\n            </menu>\n            {\n                hasOverlay && isDisplayed && (\n                    <div\n                        aria-hidden=\"true\"\n                        className=\"moonstone-menu_overlay\"\n                        onClick={onClose}\n                        onContextMenu={onClose}\n                    />\n                )\n            }\n        </>\n    );\n};\n\n// Kept defaultProps here because of unnecessary re-rendering when provided as default parameters to the function component\n/* eslint-disable react/default-props-match-prop-types */\nMenu.defaultProps = {\n    hasOverlay: true,\n    hasSearch: false,\n    searchEmptyText: 'No results found.',\n    position: 'fixed',\n    anchorEl: null,\n    anchorPosition: {\n        top: 0,\n        left: 0\n    },\n    anchorElOrigin: {\n        vertical: 'bottom',\n        horizontal: 'left'\n    },\n    transformElOrigin: {\n        vertical: 'top',\n        horizontal: 'left'\n    }\n};\n/* eslint-enable react/default-props-match-prop-types */\n\nMenu.displayName = 'Menu';\n"]}