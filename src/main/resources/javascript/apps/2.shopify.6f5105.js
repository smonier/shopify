(self.webpackChunk_jahia_shopify=self.webpackChunk_jahia_shopify||[]).push([[2],{2:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>B});var o=n(826),r=n(970),a=n.n(r),i=n(556),l=n.n(i),s=n(71);function c(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;n[o]=e[o]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function p(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=u(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,"string");if("object"!=u(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==u(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e){var t,n,o="";if("string"==typeof e||"number"==typeof e)o+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=d(e[t]))&&(o&&(o+=" "),o+=n);else for(t in e)e[t]&&(o&&(o+=" "),o+=t);return o}const f=function(){for(var e,t,n=0,o="";n<arguments.length;)(e=arguments[n++])&&(t=d(e))&&(o&&(o+=" "),o+=t);return o};var m=["children","component","variant","weight","className","hasLineThrough","isItalic","isUpperCase","isNowrap","isHtml"];function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var b=function(e){var t=e.children,n=void 0===t?"":t,o=e.component,r=void 0===o?"p":o,i=e.variant,l=void 0===i?"body":i,s=e.weight,u=void 0===s?"default":s,p=e.className,d=void 0===p?"":p,g=e.hasLineThrough,b=void 0!==g&&g,y=e.isItalic,v=void 0!==y&&y,w=e.isUpperCase,O=void 0!==w&&w,C=e.isNowrap,_=void 0!==C&&C,S=(e.isHtml,c(e,m));return n?a().createElement(r,h(h({},function(e){var t=h({},e);return t.isHtml&&delete t.isHtml,t}(S)),{},{className:f("moonstone-typography","moonstone-variant_".concat(l),"moonstone-weight_".concat(u),d,{"moonstone-nowrap":_},{"moonstone-italic":v},{"moonstone-upperCase":O},{"moonstone-lineThrough":b})}),n):null};function y(){return y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)({}).hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},y.apply(null,arguments)}b.displayName="Typography";var v=["size","className","isReversed"],w=function(e){var t=e.size,n=e.className,o=e.isReversed,r=void 0!==o&&o,i=c(e,v);return a().createElement("svg",y({role:"status",className:f("moonstone-loader","moonstone-loader_".concat(t),n)},i),a().createElement("circle",{className:f("moonstone-loader_circle","moonstone-loader_background"),cx:"50%",cy:"50%"}),a().createElement("circle",{className:f("moonstone-loader_circle","moonstone-loader_animation",{"moonstone-loader_reversed":r}),cx:"50%",cy:"50%"}))};w.displayName="Loader";var O=["label","size","isReversed","isDisabled","isLoading","icon","variant","color","className","isHtml","onClick"],C=function(e){var t=e.label,n=void 0===t?"":t,o=e.size,i=void 0===o?"default":o,l=e.isReversed,s=void 0!==l&&l,u=e.isDisabled,p=void 0!==u&&u,d=e.isLoading,m=void 0!==d&&d,g=e.icon,h=void 0===g?null:g,v=e.variant,C=void 0===v?"default":v,_=e.color,S=void 0===_?"default":_,j=e.className,N=void 0===j?null:j,E=e.isHtml,x=void 0!==E&&E,R=e.onClick,P=void 0===R?function(){}:R,T=c(e,O),k="default",L=(0,r.useRef)(null);"small"===i&&(k="light"),"big"===i&&(k="semiBold");var I=Boolean("default"===C&&("accent"===S||"danger"===S));return a().createElement("button",y({ref:L,className:f("moonstone-button","moonstone-size_".concat(i),"moonstone-variant_".concat(C),"moonstone-color_".concat(S),{"moonstone-icon":h&&n},{"moonstone-icon-button":!n},{"moonstone-reverse":s},{"moonstone-button_loading":m},N),type:"button",disabled:p,onClick:function(e){return function(e){P(e),L.current.blur()}(e)}},T),m&&a().createElement(w,{size:"small",isReversed:I,className:f("moonstone-button_loader")}),h&&a().createElement(h.type,y({},h.props,{size:"big"===i?"default":i})),n&&a().createElement(b,{isNowrap:!0,component:"span",variant:"button",isUpperCase:"big"===i,weight:k,className:f("flexFluid"),isHtml:x},n))};C.displayName="Button";var _=n(239),S=n(348),j=n(135);const N=e=>{let{status:t}=e;return a().createElement("div",{className:"flexFluid flexCol_center alignCenter",style:{backgroundColor:"var(--color-light)",display:t?"block":"none"}},a().createElement(w,{size:"big"}))};var E,x=n(742),R=n.n(x),P=n(278),T=n(890);const k=n.n(T)()(E||(L=['\n    query getShops($path: String!, $language: String!) {\n        jcr {\n            result: nodeByPath(path: $path) {\n                ...NodeCacheRequiredFields\n                value: uuid\n                label: displayName(language: $language)\n                shops: property(name: "shopName") {\n                    refNodes {\n                      ...NodeCacheRequiredFields\n                      name: displayName(language: $language)\n                    }\n                }\n            }\n        }\n    }\n    ',""],I||(I=L.slice(0)),E=Object.freeze(Object.defineProperties(L,{raw:{value:Object.freeze(I)}}))),S.PredefinedFragments.nodeCacheRequiredFields.gql);var L,I;const z=e=>{let{path:t,isOpen:n,onCloseDialog:o}=e;const{t:i}=(0,_.useTranslation)("shopify"),{language:l,site:c}=(0,j.useSelector)((e=>({language:e.language,site:e.site}))),{siteInfo:u,loading:p}=(0,S.useSiteInfo)({siteKey:c,displayLanguage:l}),{node:d,loading:f}=(0,S.useNodeInfo)({path:t,language:l},{getDisplayName:!0}),[m,g]=(0,r.useState)([]),[h,y]=(0,r.useState)(!1),[v,w]=(0,r.useState)(null),[O,E]=(0,r.useState)(null),{data:x,errors:T,loading:L}=(0,P.useQuery)(k,{variables:{path:t,language:l}});(0,r.useEffect)((()=>{if(x&&x.jcr&&x.jcr.result&&x.jcr.result.shops&&x.jcr.result.shops.refNodes){const e=x.jcr.result.shops.refNodes.map(((e,t)=>({name:e.name})));g(e)}T&&w(T[0].message)}),[x,T]);const I=()=>{o()};return p||!u||f||!d||L?a().createElement(N,{status:!0}):a().createElement(s.Dialog,{fullWidth:!0,"aria-labelledby":"alert-dialog-slide-title",open:n,maxWidth:"sm",classes:{paper:R().dialog_overflowYVisible},onClose:o},a().createElement(s.DialogTitle,{id:"dialog-language-title"},a().createElement(b,{isUpperCase:!0,variant:"heading",weight:"bold",className:R().dialogTitle},i("shopify:label.requestShopifyProductsUpdate"))),a().createElement(s.DialogContent,{className:R().dialogContent,classes:{root:R().dialogContent_overflowYVisible}},a().createElement("div",{className:R().loaderOverlayWrapper},a().createElement(N,{status:h})),m.length>0&&a().createElement("div",{className:R().textResults},a().createElement(b,{variant:"h4",className:R().updateResultsTitle},"Products Update"),a().createElement("ul",null,!O&&m.map(((e,t)=>a().createElement("li",{key:t},"Shop: ",e.name))),O&&m.map(((e,t)=>a().createElement("li",{key:t},"Shop: ",e.name," | Products Updated: ",e.productCount))))),v&&a().createElement(b,{color:"error"},v)),a().createElement(s.DialogActions,null,!O&&a().createElement(C,{size:"big",color:"default",label:i("shopify:label.btnCancel.title"),onClick:I}),!O&&a().createElement(C,{size:"big",color:"accent",label:i("shopify:label.btnApply.title"),onClick:async()=>{y(!0),w(null);try{const e=await fetch("".concat(contextJsParameters.contextPath,"/cms/editframe/default/").concat(l).concat(t,".requestShopifyProductsUpdate.do"),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"}});if(!e.ok){const t="HTTP error! status: ".concat(e.status),n=await e.text();throw console.error(t,n),new Error(t)}let n;try{n=await e.json()}catch(e){throw console.error("Error parsing JSON:",e),new Error("Failed to parse JSON response")}200===n.resultCode?(g(n.shop||[]),E(n)):(g([]),w("Error: ".concat(n.resultCode)))}catch(e){console.error("Error updating Shopify products:",e);let t="An error occurred while updating Shopify products. Please check the console for more details.";e instanceof Error&&(t=e.message),w(t)}finally{y(!1)}}}),O&&a().createElement(C,{size:"big",color:"default",label:i("shopify:label.btnClose.title"),onClick:I})))};z.propTypes={path:l().string.isRequired,isOpen:l().bool.isRequired,onCloseDialog:l().func.isRequired};const H=["render","path"];function M(){return M=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)({}).hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},M.apply(null,arguments)}const U=e=>{let{render:t,path:n}=e,i=function(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;n[o]=e[o]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}(e,H);const{render:l,destroy:s}=(0,r.useContext)(o.ComponentRendererContext),{language:c,site:u}=(0,j.useSelector)((e=>({language:e.language,site:e.site}))),{siteInfo:p,loading:d}=(0,S.useSiteInfo)({siteKey:u,displayLanguage:c}),{node:f,loading:m}=(0,S.useNodeInfo)({path:n,language:c},{getDisplayName:!0});return f?a().createElement(t,M({},i,{onClick:()=>{l("RequestProductsUpdateDialog",z,{isOpen:!0,uuid:f.uuid,path:n,onCloseDialog:()=>s("RequestProductsUpdateDialog")})}})):(console.error("Error retreiving Node"),null)};U.propTypes={render:l().func.isRequired,path:l().string.isRequired};const D={component:U};function G(){const e=o.registry.add("action","menuActionShopify",o.menuAction,{buttonIcon:window.jahia.moonstone.toIconComponent('<svg viewBox="-18 0 292 292" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid" fill="#000000"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M223.774 57.34c-.201-1.46-1.48-2.268-2.537-2.357-1.055-.088-23.383-1.743-23.383-1.743s-15.507-15.395-17.209-17.099c-1.703-1.703-5.029-1.185-6.32-.805-.19.056-3.388 1.043-8.678 2.68-5.18-14.906-14.322-28.604-30.405-28.604-.444 0-.901.018-1.358.044C129.31 3.407 123.644.779 118.75.779c-37.465 0-55.364 46.835-60.976 70.635-14.558 4.511-24.9 7.718-26.221 8.133-8.126 2.549-8.383 2.805-9.45 10.462C21.3 95.806.038 260.235.038 260.235l165.678 31.042 89.77-19.42S223.973 58.8 223.775 57.34zM156.49 40.848l-14.019 4.339c.005-.988.01-1.96.01-3.023 0-9.264-1.286-16.723-3.349-22.636 8.287 1.04 13.806 10.469 17.358 21.32zm-27.638-19.483c2.304 5.773 3.802 14.058 3.802 25.238 0 .572-.005 1.095-.01 1.624-9.117 2.824-19.024 5.89-28.953 8.966 5.575-21.516 16.025-31.908 25.161-35.828zm-11.131-10.537c1.617 0 3.246.549 4.805 1.622-12.007 5.65-24.877 19.88-30.312 48.297l-22.886 7.088C75.694 46.16 90.81 10.828 117.72 10.828z" fill="#95BF46"></path><path d="M221.237 54.983c-1.055-.088-23.383-1.743-23.383-1.743s-15.507-15.395-17.209-17.099c-.637-.634-1.496-.959-2.394-1.099l-12.527 256.233 89.762-19.418S223.972 58.8 223.774 57.34c-.201-1.46-1.48-2.268-2.537-2.357" fill="#5E8E3E"></path><path d="M135.242 104.585l-11.069 32.926s-9.698-5.176-21.586-5.176c-17.428 0-18.305 10.937-18.305 13.693 0 15.038 39.2 20.8 39.2 56.024 0 27.713-17.577 45.558-41.277 45.558-28.44 0-42.984-17.7-42.984-17.7l7.615-25.16s14.95 12.835 27.565 12.835c8.243 0 11.596-6.49 11.596-11.232 0-19.616-32.16-20.491-32.16-52.724 0-27.129 19.472-53.382 58.778-53.382 15.145 0 22.627 4.338 22.627 4.338" fill="#FFF"></path></g></svg>'),menuRenderer:o.MenuRenderer,menuItemRenderer:o.MenuItemRenderer});o.registry.add("action","shopifyMenu",e,{buttonLabel:"shopify:label.menu",targets:["contentActions:999"],menuTarget:"shopifyMenu",isMenuPreload:!0}),o.registry.add("action","shopifyProductsUpdate",D,{targets:["shopifyMenu:1"],buttonLabel:"shopify:label.requestShopifyProductsUpdate",showOnNodeTypes:["shopifynt:productsList"]})}function B(){o.registry.add("callback","shopifyProductsUpdate",{targets:["jahiaApp-init:50"],callback:G})}console.debug("%c Shopify Products Update is activated","color: #3c8cba")},155:(e,t,n)=>{(t=n(314)(!1)).push([e.id,"._1fUsGNO9BOAkeBbdCa6aRN{margin:0 10px;color:#373c42}._2d3O3pLWgLmp9B1R0HAc6Z{margin:10px;color:#525c65}.mp0kqWdnjOTxtwrj3lj6B{display:flex;flex-wrap:nowrap;justify-content:flex-start;align-items:center;padding:40px 0 !important;border-top:1px solid #e0e6ea;border-bottom:1px solid #e0e6ea}.mp0kqWdnjOTxtwrj3lj6B._3zWE7FMqRaGmhct9fc6z-w{overflow-y:visible}._3Gh1mTXMuLLlYWCC8DS6Il{flex-grow:1;color:#525c65}._3-X8eRF0W36o3HqtchRAUY{color:#f6d62f}.Uubnp6NIBvpN4BV-H_5Iz{padding:0 10px;font-weight:bold}._5Wf9tHNWUrwS5IJ3ocfvu{margin-left:24px;padding:0 10px;font-weight:bold}._3QLanDOReb_FkrpHtH-ihI{margin-right:16px}div._3l81xFwJ7z21h5rB0jmCeR{overflow-y:visible}.G4nSaPLNfmoD4Ds4GRXP_{display:flex;justify-content:center;align-items:center;height:100%}._26tz2HTLEG33Ma9-8Q4G_S{margin:16px 0}._26tz2HTLEG33Ma9-8Q4G_S ul{list-style-type:disc;margin-left:20px;padding-left:20px}._26tz2HTLEG33Ma9-8Q4G_S li{margin-bottom:8px}._26tz2HTLEG33Ma9-8Q4G_S ._2uwHCRJhNwGaKiFbCCGaZO{color:#3f51b5;margin-bottom:16px;margin-left:10px;font-weight:bold;font-size:16px}",""]),t.locals={dialogTitle:"_1fUsGNO9BOAkeBbdCa6aRN",dialogSubTitle:"_2d3O3pLWgLmp9B1R0HAc6Z",dialogContent:"mp0kqWdnjOTxtwrj3lj6B",dialogContent_overflowYVisible:"_3zWE7FMqRaGmhct9fc6z-w",warningText:"_3Gh1mTXMuLLlYWCC8DS6Il",warningIcon:"_3-X8eRF0W36o3HqtchRAUY",label:"Uubnp6NIBvpN4BV-H_5Iz",copyFromLabel:"_5Wf9tHNWUrwS5IJ3ocfvu",language:"_3QLanDOReb_FkrpHtH-ihI",dialog_overflowYVisible:"_3l81xFwJ7z21h5rB0jmCeR",loaderOverlayWrapper:"G4nSaPLNfmoD4Ds4GRXP_",textResults:"_26tz2HTLEG33Ma9-8Q4G_S",updateResultsTitle:"_2uwHCRJhNwGaKiFbCCGaZO"},e.exports=t},314:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n,o,r,a=e[1]||"",i=e[3];if(!i)return a;if(t&&"function"==typeof btoa){var l=(n=i,o=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),r="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(o),"/*# ".concat(r," */")),s=i.sources.map((function(e){return"/*# sourceURL=".concat(i.sourceRoot||"").concat(e," */")}));return[a].concat(s).concat([l]).join("\n")}return[a].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,o){"string"==typeof e&&(e=[[null,e,""]]);var r={};if(o)for(var a=0;a<this.length;a++){var i=this[a][0];null!=i&&(r[i]=!0)}for(var l=0;l<e.length;l++){var s=[].concat(e[l]);o&&r[s[0]]||(n&&(s[2]?s[2]="".concat(n," and ").concat(s[2]):s[2]=n),t.push(s))}},t}},694:(e,t,n)=>{"use strict";var o=n(925);function r(){}function a(){}a.resetWarningCache=r,e.exports=function(){function e(e,t,n,r,a,i){if(i!==o){var l=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:a,resetWarningCache:r};return n.PropTypes=n,n}},556:(e,t,n)=>{e.exports=n(694)()},925:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},742:(e,t,n)=>{var o=n(72),r=n(155);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.id,r,""]]);o(r,{insert:"head",singleton:!1}),e.exports=r.locals||{}},72:(e,t,n)=>{"use strict";var o,r=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),a=[];function i(e){for(var t=-1,n=0;n<a.length;n++)if(a[n].identifier===e){t=n;break}return t}function l(e,t){for(var n={},o=[],r=0;r<e.length;r++){var l=e[r],s=t.base?l[0]+t.base:l[0],c=n[s]||0,u="".concat(s," ").concat(c);n[s]=c+1;var p=i(u),d={css:l[1],media:l[2],sourceMap:l[3]};-1!==p?(a[p].references++,a[p].updater(d)):a.push({identifier:u,updater:g(d,t),references:1}),o.push(u)}return o}function s(e){var t=document.createElement("style"),o=e.attributes||{};if(void 0===o.nonce){var a=n.nc;a&&(o.nonce=a)}if(Object.keys(o).forEach((function(e){t.setAttribute(e,o[e])})),"function"==typeof e.insert)e.insert(t);else{var i=r(e.insert||"head");if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(t)}return t}var c,u=(c=[],function(e,t){return c[e]=t,c.filter(Boolean).join("\n")});function p(e,t,n,o){var r=n?"":o.media?"@media ".concat(o.media," {").concat(o.css,"}"):o.css;if(e.styleSheet)e.styleSheet.cssText=u(t,r);else{var a=document.createTextNode(r),i=e.childNodes;i[t]&&e.removeChild(i[t]),i.length?e.insertBefore(a,i[t]):e.appendChild(a)}}function d(e,t,n){var o=n.css,r=n.media,a=n.sourceMap;if(r?e.setAttribute("media",r):e.removeAttribute("media"),a&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),e.styleSheet)e.styleSheet.cssText=o;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(o))}}var f=null,m=0;function g(e,t){var n,o,r;if(t.singleton){var a=m++;n=f||(f=s(t)),o=p.bind(null,n,a,!1),r=p.bind(null,n,a,!0)}else n=s(t),o=d.bind(null,n,t),r=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return o(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;o(e=t)}else r()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===o&&(o=Boolean(window&&document&&document.all&&!window.atob)),o));var n=l(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var o=0;o<n.length;o++){var r=i(n[o]);a[r].references--}for(var s=l(e,t),c=0;c<n.length;c++){var u=i(n[c]);0===a[u].references&&(a[u].updater(),a.splice(u,1))}n=s}}}}}]);
//# sourceMappingURL=2.shopify.6f5105.js.map