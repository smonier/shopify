{"version":3,"file":"58.shopify.a9b2ff.js","mappings":"sbAOO,MAAMA,EAAwBC,IAA6C,IAA5C,KAAEC,EAAMC,OAAQC,GAAuBH,EAAZI,E,yWAAUC,CAAAL,EAAAM,GACvE,MAAM,EAAEC,IAAMC,EAAAA,EAAAA,gBAAe,YACvB,SAAEC,EAAQ,KAAEC,IAASC,EAAAA,EAAAA,cAAYC,IAAS,CAAGH,SAAUG,EAAMH,SAAUC,KAAME,EAAMF,UACnF,SAAEG,EAAQ,QAAEC,IAAYC,EAAAA,EAAAA,aAAY,CAAEC,QAASN,EAAMO,gBAAiBR,KACtE,KAAES,EAAI,YAAEC,IAAgBC,EAAAA,EAAAA,aAAY,CAAEnB,KAAMA,EAAMQ,SAAUA,GAAY,CAAEY,gBAAgB,IAkDhG,OAAIP,IAAYD,GAAYM,IAAgBD,EACjC,KAKPI,IAAAA,cAACnB,EAAMoB,EAAA,GACCnB,EAAU,CACdoB,YAAajB,EAAE,qCAAsC,CAAEkB,YAAaP,EAAKO,cACzEC,QAzDYC,UAChB,IACI,MAAMC,QAAiBC,MAAM,GAADC,OAAIC,oBAAoBC,YAAW,2BAAAF,OAA0BrB,GAAQqB,OAAG7B,EAAI,oCAAoC,CACxIgC,OAAQ,OACRC,QAAS,CAAE,eAAgB,mBAAoBC,OAAQ,sBAG3D,IAAKP,EAASQ,GAAI,CACd,MAAMC,EAAe,uBAAHP,OAA0BF,EAASU,QAC/CC,QAAkBX,EAASY,OAEjC,MADAC,QAAQC,MAAML,EAAcE,GACtB,IAAII,MAAMN,EACpB,CAEA,IAAIO,EACJ,IACIA,QAAahB,EAASiB,MAC1B,CAAE,MAAOH,GAEL,MADAD,QAAQC,MAAM,sBAAuBA,GAC/B,IAAIC,MAAM,gCACpB,CAEA,GAAwB,MAApBC,EAAKE,WAAoB,CACzB,MAAMC,EAAQH,EAAKI,KACnB,IAAIC,EAAiB,+BACrBF,EAAMG,SAAQF,IACVP,QAAQU,IAAI,WAADrB,OAAYkB,EAAKI,KAAI,uBAAAtB,OAAsBkB,EAAKK,eAC3DJ,GAAkB,SAAJnB,OAAakB,EAAKI,KAAI,uBAAAtB,OAAsBkB,EAAKK,aAAY,OAAM,IAGrFC,MAAML,EAEV,MACIK,MAAM,UAADxB,OAAWc,EAAKE,YAG7B,CAAE,MAAOJ,GACLD,QAAQC,MAAM,mCAAoCA,GAElD,IAAIL,EAAe,gGACfK,aAAiBC,QACjBN,EAAeK,EAAMa,SAGzBD,MAAMjB,EACV,KAaE,EChEK,SAAS,IAEpB,MAAMmB,EAAyBC,EAAAA,SAASC,IAAI,SAAU,oBAAqBC,EAAAA,WAAY,CACnFC,WAAYC,OAAOC,MAAMC,UAAUC,gBAAgB,60DACnDC,aAAcC,EAAAA,aACdC,iBAAkBC,EAAAA,mBAGtBX,EAAAA,SAASC,IAAI,SAAU,cAAeF,EAAwB,CAC1DhC,YAAa,qBACb6C,QAAS,CAAC,sBACVC,WAAY,cACZC,eAAe,IAGnBd,EAAAA,SAASC,IAAI,SAAU,wBAAyB,CAC5CW,QAAS,CAAC,iBACVG,gBAAiB,CAAC,0BAClBC,UAAW1E,GAEnB,CCxBe,SAAS,IACpB0D,EAAAA,SAASC,IAAI,WAAY,wBAAyB,CAC9CW,QAAS,CAAC,oBACVK,SAAUC,GAElB,CAEAlC,QAAQmC,MAAM,0CAA2C,iB","sources":["webpack://@jahia/shopify/./src/javascript/ShopifyProductsUpdate/RequestProductsUpdate.jsx","webpack://@jahia/shopify/./src/javascript/ShopifyProductsUpdate/Shopify.register.js","webpack://@jahia/shopify/./src/javascript/init.js"],"sourcesContent":["import React from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { useSiteInfo, useNodeInfo } from '@jahia/data-helper';\nimport { useSelector } from 'react-redux';\n\n\n\nexport const RequestProductsUpdate = ({ path, render: Render, ...otherProps }) => {\n    const { t } = useTranslation('shopify');\n    const { language, site } = useSelector(state => ({ language: state.language, site: state.site }));\n    const { siteInfo, loading } = useSiteInfo({ siteKey: site, displayLanguage: language });\n    const { node, nodeLoading } = useNodeInfo({ path: path, language: language }, { getDisplayName: true });\n\n    const handleClick = async () => {\n        try {\n            const response = await fetch(`${contextJsParameters.contextPath}/cms/editframe/default/${language}${path}.requestShopifyProductsUpdate.do`, {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json', Accept: 'application/json' }\n            });\n\n            if (!response.ok) {\n                const errorMessage = `HTTP error! status: ${response.status}`;\n                const errorBody = await response.text();\n                console.error(errorMessage, errorBody);\n                throw new Error(errorMessage);\n            }\n\n            let data;\n            try {\n                data = await response.json();\n            } catch (error) {\n                console.error('Error parsing JSON:', error);\n                throw new Error('Failed to parse JSON response');\n            }\n\n            if (data.resultCode === 200) {\n                const shops = data.shop;\n                let messageContent = \"Products Update Result\\n\\n\\n\";\n                shops.forEach(shop => {\n                    console.log(`  Shop: ${shop.name}, Product Updated: ${shop.productCount}`);\n                    messageContent += `Shop: ${shop.name}, Product Updated: ${shop.productCount}\\n\\n`;\n                });\n\n                alert(messageContent);\n\n            } else {\n                alert(`Error: ${data.resultCode}`);\n\n            }\n        } catch (error) {\n            console.error('Error updating Shopify products:', error);\n\n            let errorMessage = 'An error occurred while updating Shopify products. Please check the console for more details.';\n            if (error instanceof Error) {\n                errorMessage = error.message;\n            }\n\n            alert(errorMessage);\n        }\n    };\n\n    if (loading || !siteInfo || nodeLoading || !node) {\n        return null;\n    }\n\n    return (\n\n        <Render\n            {...otherProps}\n            buttonLabel={t('label.requestShopifyProductsUpdate', { displayName: node.displayName })}\n            onClick={handleClick}\n        />);\n};\n","import {menuAction,\n    MenuItemRenderer,\n    MenuRenderer,\n    registry\n    } from '@jahia/ui-extender';\nimport {RequestProductsUpdate} from './RequestProductsUpdate';\n\nexport default function () {\n\n    const menuActionWithRenderer = registry.add('action', 'menuActionShopify', menuAction, {\n        buttonIcon: window.jahia.moonstone.toIconComponent('<svg viewBox=\"-18 0 292 292\" xmlns=\"http://www.w3.org/2000/svg\" preserveAspectRatio=\"xMidYMid\" fill=\"#000000\"><g id=\"SVGRepo_bgCarrier\" stroke-width=\"0\"></g><g id=\"SVGRepo_tracerCarrier\" stroke-linecap=\"round\" stroke-linejoin=\"round\"></g><g id=\"SVGRepo_iconCarrier\"><path d=\"M223.774 57.34c-.201-1.46-1.48-2.268-2.537-2.357-1.055-.088-23.383-1.743-23.383-1.743s-15.507-15.395-17.209-17.099c-1.703-1.703-5.029-1.185-6.32-.805-.19.056-3.388 1.043-8.678 2.68-5.18-14.906-14.322-28.604-30.405-28.604-.444 0-.901.018-1.358.044C129.31 3.407 123.644.779 118.75.779c-37.465 0-55.364 46.835-60.976 70.635-14.558 4.511-24.9 7.718-26.221 8.133-8.126 2.549-8.383 2.805-9.45 10.462C21.3 95.806.038 260.235.038 260.235l165.678 31.042 89.77-19.42S223.973 58.8 223.775 57.34zM156.49 40.848l-14.019 4.339c.005-.988.01-1.96.01-3.023 0-9.264-1.286-16.723-3.349-22.636 8.287 1.04 13.806 10.469 17.358 21.32zm-27.638-19.483c2.304 5.773 3.802 14.058 3.802 25.238 0 .572-.005 1.095-.01 1.624-9.117 2.824-19.024 5.89-28.953 8.966 5.575-21.516 16.025-31.908 25.161-35.828zm-11.131-10.537c1.617 0 3.246.549 4.805 1.622-12.007 5.65-24.877 19.88-30.312 48.297l-22.886 7.088C75.694 46.16 90.81 10.828 117.72 10.828z\" fill=\"#95BF46\"></path><path d=\"M221.237 54.983c-1.055-.088-23.383-1.743-23.383-1.743s-15.507-15.395-17.209-17.099c-.637-.634-1.496-.959-2.394-1.099l-12.527 256.233 89.762-19.418S223.972 58.8 223.774 57.34c-.201-1.46-1.48-2.268-2.537-2.357\" fill=\"#5E8E3E\"></path><path d=\"M135.242 104.585l-11.069 32.926s-9.698-5.176-21.586-5.176c-17.428 0-18.305 10.937-18.305 13.693 0 15.038 39.2 20.8 39.2 56.024 0 27.713-17.577 45.558-41.277 45.558-28.44 0-42.984-17.7-42.984-17.7l7.615-25.16s14.95 12.835 27.565 12.835c8.243 0 11.596-6.49 11.596-11.232 0-19.616-32.16-20.491-32.16-52.724 0-27.129 19.472-53.382 58.778-53.382 15.145 0 22.627 4.338 22.627 4.338\" fill=\"#FFF\"></path></g></svg>'),\n        menuRenderer: MenuRenderer,\n        menuItemRenderer: MenuItemRenderer\n    });\n\n    registry.add('action', 'shopifyMenu', menuActionWithRenderer, {\n        buttonLabel: 'shopify:label.menu',\n        targets: ['contentActions:999'],\n        menuTarget: 'shopifyMenu',\n        isMenuPreload: true\n    });\n\n    registry.add('action', 'shopifyProductsUpdate', {\n        targets: ['shopifyMenu:1'],\n        showOnNodeTypes: ['shopifynt:productsList'],\n        component: RequestProductsUpdate\n    });\n}\n\n","import {registry} from '@jahia/ui-extender';\nimport register from './ShopifyProductsUpdate/Shopify.register';\n\nexport default function () {\n    registry.add('callback', 'shopifyProductsUpdate', {\n        targets: ['jahiaApp-init:50'],\n        callback: register\n    });\n}\n\nconsole.debug('%c Shopify Products Update is activated', 'color: #3c8cba');"],"names":["RequestProductsUpdate","_ref","path","render","Render","otherProps","_objectWithoutProperties","_excluded","t","useTranslation","language","site","useSelector","state","siteInfo","loading","useSiteInfo","siteKey","displayLanguage","node","nodeLoading","useNodeInfo","getDisplayName","React","_extends","buttonLabel","displayName","onClick","async","response","fetch","concat","contextJsParameters","contextPath","method","headers","Accept","ok","errorMessage","status","errorBody","text","console","error","Error","data","json","resultCode","shops","shop","messageContent","forEach","log","name","productCount","alert","message","menuActionWithRenderer","registry","add","menuAction","buttonIcon","window","jahia","moonstone","toIconComponent","menuRenderer","MenuRenderer","menuItemRenderer","MenuItemRenderer","targets","menuTarget","isMenuPreload","showOnNodeTypes","component","callback","register","debug"],"sourceRoot":""}